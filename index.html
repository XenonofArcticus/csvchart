<!DOCTYPE html>

<html>
<head>
	<title>Read Text File</title>
	<script type="text/javascript" src="papaparse.js"></script>
	<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
	<script type="text/javascript">
		google.charts.load("current", {"packages":["corechart"]});
		// google.charts.setOnLoadCallback(drawChart);

		function drawChart(d) {
			var data = google.visualization.arrayToDataTable(d);

			/* var data = google.visualization.arrayToDataTable([
				["Age", "Weight"],
				[8, 12],
				[4, 5.5],
				[11, 14],
				[4, 5],
				[3, 3.5],
				[6.5, 7]
			]); */

			var options = {
				title: "AlphaPixel Test",
				hAxis: {title: "Foo", minValue: 0, maxValue: 15},
				vAxis: {title: "Bar", minValue: 0, maxValue: 15},
				legend: "none"
			};

			var chart = new google.visualization.ScatterChart(document.getElementById("chart_div"));

			chart.draw(data, options);
		}

		var csv;
	</script>
</head>
<body>
	<input type="file" name="inputfile" id="inputfile">
	<br>
	<pre id="output"></pre>
	<script type="text/javascript">
		document.getElementById("inputfile").addEventListener("change", function() {
			var fr = new FileReader();

			// https://www.papaparse.com/docs#config
			fr.onload = function() {
				csv = Papa.parse(fr.result, {
					dynamicTyping: true,
					skipEmptyLines: true
				});

				// document.getElementById("output").textContent = fr.result;
				document.getElementById("output").textContent = csv;

				drawChart(csv.data);
			}

			fr.readAsText(this.files[0]);
		})
	</script>
	<div id="chart_div" style="width: 900px; height: 500px;"></div>
</body>
</html>
